<!doctype html>
<html lang="ch">
<head>
	<meta charset="utf-8">
	<link rel="shortcut icon" href="logo.ico" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="zol后台">
	<meta name="keywords" content="zol后台 ">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="format-detection" content="telephone=no">
	<title>zol后台</title>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script>
		$(function() {
			$(".meun-item").click(function() {
				$(".meun-item").removeClass("meun-item-active");
				$(this).addClass("meun-item-active");
				var itmeObj = $(".meun-item").find("img");
				itmeObj.each(function() {
					var items = $(this).attr("src");
					items = items.replace("_grey.png", ".png");
					items = items.replace(".png", "_grey.png")
					$(this).attr("src", items);
				});
				var attrObj = $(this).find("img").attr("src");;
				attrObj = attrObj.replace("_grey.png", ".png");
				$(this).find("img").attr("src", attrObj);
			});
			$("#topAD").click(function() {
				$("#topA").toggleClass(" glyphicon-triangle-right");
				$("#topA").toggleClass(" glyphicon-triangle-bottom");
			});
				$("#topBD").click(function() {
					$("#topB").toggleClass(" glyphicon-triangle-right");
					$("#topB").toggleClass(" glyphicon-triangle-bottom");
				});
				$("#topCD").click(function() {
					$("#topC").toggleClass(" glyphicon-triangle-right");
					$("#topC").toggleClass(" glyphicon-triangle-bottom");
				});
				$(".toggle-btn").click(function() {
					$("#leftMeun").toggleClass("show");
					$("#rightContent").toggleClass("pd0px");
				})
			})
		</script>
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="css/common.css" />
		<link rel="stylesheet" type="text/css" href="css/slide.css" />
		<link rel="stylesheet" type="text/css" href="css/flat-ui.min.css" />
		<link rel="stylesheet" type="text/css" href="css/jquery.nouislider.css">
		<link rel="stylesheet" type="text/css" href="css/index.css" />
	</head>
	<body>
		<div id="wrap">
			<!-- 左侧菜单栏目块 -->
			<div class="leftMeun" id="leftMeun">
				<div id="logoDiv">
					<p id="logoP"><span>欢迎来到zol后台系统</span></p>
				</div>
				<div id="personInfor">
					<p>
						<a>退出登录</a>
					</p>
				</div>
				<div class="meun-item meun-item-active" href="#sour" aria-controls="sour" role="tab" data-toggle="tab"><img src="images/icon_source.png">商品管理</div>
				<div class="meun-item" href="#user" aria-controls="user" role="tab" data-toggle="tab"><img src="images/icon_user_grey.png">用户管理</div>
			</div>
			<!-- 右侧具体内容栏目 -->
			<div id="rightContent">
				<a class="toggle-btn" id="nimei">
					<i class="glyphicon glyphicon-align-justify"></i>
				</a>
				<!-- Tab panes -->
				<div class="tab-content">
					<!-- 资源管理模块 -->
					<div role="tabpanel" class="tab-pane active" id="sour">
						<div class="check-div form-inline">
							<button class="btn btn-yellow btn-xs" data-toggle="modal" data-target="#addSource">添加资源</button>
						</div>
						<div class="data-div">
							<div class="row tableHeader">
								<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 ">
									编码ID
								</div>
								<div class="col-lg-2 col-md-1 col-sm-1 col-xs-1 ">
									商品简介
								</div>
				                
								<div class="col-lg-4 col-md-1 col-sm-1 col-xs-1 ">
									商品详情
								</div>
								<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 ">
								    原价
								</div>
								<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 ">
								    现价
								</div>
								<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 ">
								    优惠
								</div>
								<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 ">
								    图片
								</div>
								<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1 ">
								    操作
								</div>
							</div>
							<div class="tablebody" id="table">
								<!--<div class="row" id="ddiv">
									<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
										001
									</div>
									<div id="topAD" class="col-lg-2 col-md-1 col-sm-1 col-xs-1 ">
										佳能
									</div>
									<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4" >
										含票包邮！
									</div>
									<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
										4199
									</div>
									<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
										3999
									</div>
									<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
										9.5折
									</div>
									<div class="ndiv3" class="col-lg-5 col-md-5 col-sm-5 col-xs-5" style="white-space: nowrap; overflow: hidden;">
										<img style="width: 60px;height: 60px;" src="../zol团购/img/tu1.png"/>
									</div>
									<div class="ndiv2 col-lg-2 col-md-2 col-sm-2 col-xs-2">
										<button class="btn btn-success btn-xs" data-toggle="modal" data-target="#changeSource">修改</button>
										<button class="btn btn-danger btn-xs deletebtn" data-toggle="modal" data-target="#deleteSource" id="deletebtn">删除</button>
									</div>
								</div>-->
							</div>
						</div>
							<!--删除-->
						<script type="text/javascript">
						$(".deletebtn").click(function(){
							var pid = parseInt($(this).parent().parent().children().eq(0).html())
							alert("需要删除的id"+pid+"");
						})
					</script>
						<!--页码块-->
						<footer class="footer">
							<ul class="pagination" id="myul">
								<li>
									<i class="glyphicon glyphicon-menu-left" id="myli1">
										</i>
								</li>
								<li>
									<i class="glyphicon glyphicon-menu-right" id="myli2">
										</i>
								</li>
							</ul>
						</footer>
						<!--弹出窗口 添加资源-->
							<div class="modal fade" id="addSource" role="dialog" aria-labelledby="gridSystemModalLabel">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
										<h4 class="modal-title" id="gridSystemModalLabel">添加商品</h4>
									</div>
									<div class="modal-body">
										<div class="container-fluid">
											<form class="form-horizontal">
												<div class="form-group ">
													<label for="sName" class="col-xs-3 control-label">商品ID：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="addid" placeholder="">
													</div>
												</div>

												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品简介：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="addp1" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品详情：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="addp2" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品优惠：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="addyouhui" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品原价：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="addyuanjia" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sOrd" class="col-xs-3 control-label">商品价格：</label>
													<div class="col-xs-8">
														<input type="text" class="form-control input-sm duiqi" id="addprice" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sKnot" class="col-xs-3 control-label">图片地址：</label>
													<div class="col-xs-8">
														<input type="text" class="form-control input-sm duiqi" id="addimgsrc" placeholder="">
													</div>
												</div>
											</form>
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-xs btn-xs btn-white" data-dismiss="modal">取 消</button>
										<button type="button" class="btn btn-xs btn-xs btn-green" id="addsrue">保 存</button>
									</div>
								</div>
							</div>
						</div>
						<!--增加商品的javascript-->
	<script type="text/javascript">
	$("#addsrue").click(function(){
             var pYuanjia=$("#addyuanjia").val();
            var pP1=$("#addp1").val();
            var pP2=$("#addp2").val();
            var pId=$("#addid").val();
            var pPrice=$("#addprice").val();
            var pImgsrc=$("#addimgsrc").val();
            var pYouhui=$("#addyouhui").val();

            var dataJsonOb={
                 "id":pId,
                "p1":pP1,
                "p2":pP2,
                "youhui":pYouhui,
                "yuanjia":pYuanjia,
                "price":pPrice,
                "imgsrc":pImgsrc
            }
            var dataJsonStr=JSON.stringify(dataJsonOb);
            $.ajax({
                url:"../../product/CreateUpdateProduct_post",
                data:{
                    "id":pId,
                    "datajson":dataJsonStr
                },
                success:function(data){
                    if(data==1){
                        alert("创建成功");
                    
                        
                    }else{
                        alert("创建失败");
                    }
                },
                error:function(){
                    alert("ajax error");
                },
                dataType:"json",
                type:"post"
            })
        });
        var pageSizeV =10;
        var pageIndexV=1;
		var omli1=document.getElementById("myli1");
		var omli2=document.getElementById("myli2");
		var otable=document.getElementById("table");
		var divList=otable.getElementsByTagName("div");
		fn(pageIndexV);
		omli2.onclick=function(){
			pageIndexV++;
			fn(pageIndexV);
		}
		omli1.onclick=function(){
			if(pageIndexV>1){
				pageIndexV--;
			}else{
				pageIndexV=1;
			}
			
			fn(pageIndexV);
			
		}
		console.log(pageIndexV);
		function fn(pageIndexV){
         $.ajax({
            url:"../../product/GetProductsByPage_get",
            data:{
                "pagesize":pageSizeV,
                "pageindex":pageIndexV
            },
            success:function(data){
                //data  array
                
                $("#table").html("");
                for(var i=0;i<data.length;i++){
                    //把data 里面的string 主动转成对象；
                    var dataObj=JSON.parse(data[i].Data);
                    var trOb="<div class='row' id='ndiv'><div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>"+dataObj.id+"</div><div id='topAD' class='col-lg-2 col-md-1 col-sm-1 col-xs-1'>"+dataObj.p1+"</div><div class='col-lg-4 col-md-4 col-sm-4 col-xs-1'>"+dataObj.p2+"</div><div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>"+dataObj.yuanjia+"</div><div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>"+dataObj.price+"</div><div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>"+dataObj.youhui+"</div><div class='ndiv3' style='white-space:nowrap;overflow:hidden;'><img style='width:60px;height:60px;' src='../zol团购/img/"+dataObj.imgsrc+"'/></div><div class='ndiv2 col-lg-2 col-md-2 col-sm-2 col-xs-2'><button class='btn btn-success btn-xs' data-toggle='modal' data-target='#changeSource' >修改</button><button class=btn btn-danger btn-xs deletebtn' data-toggle='modal' data-target='#deleteSource' id='deletebtn'>删除</button></div>";
                    $("#table").append(trOb);
                }
            },
            dataType:"json"
        });
		}
	</script>
						<!--修改资源弹出窗口-->
						<div class="modal fade" id="changeSource" role="dialog" aria-labelledby="gridSystemModalLabel">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
										<h4 class="modal-title" id="gridSystemModalLabel">修改资源</h4>
									</div>
									<div class="modal-body">
										<div class="container-fluid">
											<form class="form-horizontal">
												<div class="form-group ">
													<label for="sName" class="col-xs-3 control-label">商品ID：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="updateid" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品简介：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="updatep1" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品详情：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="updatep2" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品优惠：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="updateyouhui" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">商品原价：</label>
													<div class="col-xs-8 ">
														<input type="text" class="form-control input-sm duiqi" id="updateyuanjia" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sOrd" class="col-xs-3 control-label">商品价格：</label>
													<div class="col-xs-8">
														<input type="text" class="form-control input-sm duiqi" id="updateprice" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sKnot" class="col-xs-3 control-label">图片地址：</label>
													<div class="col-xs-8">
														<input type="text" class="form-control input-sm duiqi" id="updateimgsrc" placeholder="">
													</div>
												</div>
											</form>
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
										<button type="button" class="btn btn-xs btn-green" id="updatesure">保 存</button>
									</div>
								</div>
							</div>
						</div>
						<!--修改商品的javascript-->
						<script type="text/javascript">
									$("#updatesure").click(function(){
		function UrlSearch()
        {
            var name,value;
            var str=location.href; //取得地址栏的url
            var num=str.indexOf("?");  //？ 的位置
            str=str.substr(num+1); //取得所有参数  获取？后面的url内容。
            var arr=str.split("&"); //各个参数放到数组里  ["pid=1"]
            for(var i=0;i < arr.length;i++){
                num=arr[i].indexOf("=");
                if(num>0){
                    name=arr[i].substring(0,num);
                    value=arr[i].substr(num+1);
                    this[name]=value;
                }
            }
        }
        var request=new UrlSearch(); //实例化
        var pid=request.id;
        $.ajax({
            url:"../product/GetProductById_get?id="+pid,
            success:function(data){ //data  { id:101,Data:"string json"}
                var dataJsonOB=JSON.parse(data.Data);
                $("#updateid").val(dataJsonOB.id);
                $("#updatep1").val(dataJsonOB.p1);
                $("#updatep2").val(dataJsonOB.p2);
                 $("#updateyouhui").val(dataJsonOB.youhui);
                  $("#updateyuanjia").val(dataJsonOB.yuanjia);
                $("#txtprice").val(dataJsonOB.price);
                $("#txtimgsrc").val(dataJsonOB.imgsrc);
            },
            dataType:"json"
        });
			var pYuanjia=$("#addyuanjia").val();
            var pP1=$("#updatep1").val();
            var pP2=$("#updatep2").val();
            var pId=$("#updateid").val();
            var pPrice=$("#updateprice").val();
            var pImgsrc=$("#updateimgsrc").val();
            var pYouhui=$("#updateyouhui").val();

            var dataJsonOb={
                 "id":pId,
                "p1":pP1,
                "p2":pP2,
                "youhui":pYouhui,
                "yuanjia":pYuanjia,
                "price":pPrice,
                "imgsrc":pImgsrc
            }
            var dataJsonStr=JSON.stringify(dataJsonOb);
            $.ajax({
                url:"../../product/CreateUpdateProduct_post",
                data:{
                    "id":pId,
                    "datajson":dataJsonStr
                },
                success:function(data){
                    if(data==1){
                        alert("修改成功");
                    }else{
                        alert("修改失败");
                    }
                },
                error:function(){
                    alert("ajax error");
                },
                dataType:"json",
                type:"post"
                })
            });
				</script>
					</div>
					<!--用户管理模块-->
					<div role="tabpanel" class="tab-pane" id="user">
						<div class="check-div form-inline">
							<div class="col-xs-3">
								<button class="btn btn-yellow btn-xs" data-toggle="modal" data-target="#addUser">添加用户 </button>
							</div>
							<div class="col-xs-4">
								<input type="text" class="form-control input-sm" placeholder="输入文字搜索">
								<button class="btn btn-white btn-xs ">查 询 </button>
							</div>
							<div class="col-lg-3 col-lg-offset-2 col-xs-4" style=" padding-right: 40px;text-align: right;">
								<label for="paixu">排序:&nbsp;</label>
								<select class=" form-control">
									<option>地区</option>
									<option>地区</option>
									<option>班期</option>
									<option>性别</option>
									<option>年龄</option>
									<option>份数</option>
								</select>
							</div>
						</div>
						<div class="data-div">
							<div class="row tableHeader">
								<div class="col-xs-2 ">
									用户名
								</div>
								<div class="col-xs-2 ">
									密码
								</div>
							</div>
							<div class="tablebody" id="mytable">

								<!--<div class="row"  >
									<div class="col-xs-2 ">
										goodmoning
									</div>
									<div class="col-xs-2">
										1234545
									</div>
									-->
									<!--<div class="col-xs-2">
										<button class="btn btn-success btn-xs" data-toggle="modal" data-target="#reviseUser">修改</button>
										<button class="btn btn-danger btn-xs" data-toggle="modal" data-target="#deleteUser">删除</button>
									</div>-->
								</div>
							</div>
						<footer class="footer">
							<ul class="pagination">
								<li>
									<i class="glyphicon glyphicon-menu-left" id="myleft">
										</i>
								</li>
								<li>
									<i class="glyphicon glyphicon-menu-right" id="myright">
										</i>
								</li>
							</ul>
						</footer>
						</script>-->
						</div>
							<script>
							var arrUser;
							var pageindex=0;
							
						   var oDiv1 = document.getElementById("mytable");
								 var xhr;
						        if (window.XMLHttpRequest) {
						        xhr = new XMLHttpRequest();
						        } else {
						        xhr = new ActiveXObject("Microsoft.XMLHTTP");
						        }
						
						        xhr.onreadystatechange = function () {
						        if (xhr.readyState == 4) {
						        if (xhr.status == 200) {
						        arrUser = eval("(" + xhr.responseText + ")");
						        fn1(pageindex);
						        var myleft=document.getElementById("myleft");
						        var myright=document.getElementById("myright");
						       
						        myright.onclick=function(){
						        	oDiv1.innerHTML="";
						        	pageindex=pageindex+2;
						        	
						        	fn1(pageindex);
						        }
						        myleft.onclick=function(){
						        	$("#mytable").html("");
						        	pageindex=pageindex-2;
						        	if(pageindex<0){
						        		pageindex=0;
						        	}
						        	
						        	fn1(pageindex);
						        }
								var myright=document.getElementById("myright");
								function fn1(pageindex){
								for(var i =pageindex;i<2+pageindex;i++){
						        oDiv1.innerHTML+=("<div class='row'><div class='col-xs-2'>"+arrUser[i].Name+"</div><div class='col-xs-2'>"+arrUser[i].password+"</div></div>")
						        }
						        } 
								}
						        else {
						        alert("失败");
						        }
						        }
						        }
						      	xhr.open("get", "http://localhost:8080/user/getAllUsers", true);
						        xhr.send();
								
						    
						</script>
						<!--弹出添加用户窗口-->
						<!--<div class="modal fade" id="addUser" role="dialog" aria-labelledby="gridSystemModalLabel">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
										<h4 class="modal-title" id="gridSystemModalLabel">添加用户</h4>
									</div>
									<div class="modal-body">
										<div class="container-fluid">
											<form class="form-horizontal">
												
												<div class="form-group ">
													<label for="sName" class="col-xs-3 control-label">用户名：</label>
													<div class="col-xs-8 ">
														<input type="email" class="form-control input-sm duiqi" id="sname" placeholder="">
													</div>
												</div>
												<div class="form-group ">
													<label for="sName" class="col-xs-3 control-label">密码：</label>
													<div class="col-xs-8 ">
														<input type="email" class="form-control input-sm duiqi" id="spassword" placeholder="">
													</div>
												</div>
											</form>
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
										<button type="button" class="btn btn-xs btn-green">保 存</button>
									</div>
								</div>
							</div>
						</div>-->
						<!--<div class="modal fade" id="reviseUser" role="dialog" aria-labelledby="gridSystemModalLabel">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
										<h4 class="modal-title" id="gridSystemModalLabel">修改用户</h4>
									</div>
									<div class="modal-body">
										<div class="container-fluid">
											<form class="form-horizontal">
												<div class="form-group ">
													<label for="sName" class="col-xs-3 control-label">用户名：</label>
													<div class="col-xs-8 ">
														<input type="email" class="form-control input-sm duiqi" id="sName" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sLink" class="col-xs-3 control-label">真实姓名：</label>
													<div class="col-xs-8 ">
														<input type="" class="form-control input-sm duiqi" id="sLink" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sOrd" class="col-xs-3 control-label">电子邮箱：</label>
													<div class="col-xs-8">
														<input type="" class="form-control input-sm duiqi" id="sOrd" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sKnot" class="col-xs-3 control-label">电话：</label>
													<div class="col-xs-8">
														<input type="" class="form-control input-sm duiqi" id="sKnot" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sKnot" class="col-xs-3 control-label">地区：</label>
													<div class="col-xs-8">
														<input type="" class="form-control input-sm duiqi" id="sKnot" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="sKnot" class="col-xs-3 control-label">权限：</label>
													<div class="col-xs-8">
														<input type="" class="form-control input-sm duiqi" id="sKnot" placeholder="">
													</div>
												</div>
												<div class="form-group">
													<label for="situation" class="col-xs-3 control-label">状态：</label>
													<div class="col-xs-8">
														<label class="control-label" for="anniu">
															<input type="radio" name="situation" id="normal">正常</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
														<label class="control-label" for="meun">
															<input type="radio" name="situation" id="forbid"> 禁用</label>
													</div>
												</div>
											</form>
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
										<button type="button" class="btn btn-xs btn-green">保 存</button>
									</div>
								</div>
							</div>
						</div>-->
					</div>
					</div>
				</div>
			</div>
		</div>
		<script src="js/jquery.nouislider.js"></script>
	</body>
</html>